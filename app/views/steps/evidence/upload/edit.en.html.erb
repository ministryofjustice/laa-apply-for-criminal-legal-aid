<% title t('.page_title') %>
<% step_header %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <%= render partial: 'shared/flash_banner' %>

    <h1 class="govuk-heading-xl"><%= t('.heading') %></h1>

    <p class="govuk-body govuk-!-margin-bottom-1">
      <%= t('.explanation') %>
    </p>

    <%# TODO: dynamic list depending on evidence requirements %>
    <ul class="govuk-list govuk-list--bullet">
      <li>evidence your client gets a passporting benefit</li>
    </ul>

    <p class="govuk-body">
      <%= t('.recent_docs') %>
    </p>

    <h2 class="govuk-heading-m">
      <%= t('.upload_files_heading') %>
      <span class="govuk-caption-m govuk-!-padding-top-2">
        <%= t('.upload_files_info', max_size: FileUploadValidator::MAX_FILE_SIZE) %>
      </span>
    </h2>

    <%= form_for @form_object, html: { id: 'dz-evidence-upload-form', class: 'dropzone' },
                 url: crime_application_documents_path,
                 method: :post, multipart: true do |f| %>

      <%= f.button t('.choose_files_button'),
                   id: 'choose_files_button',
                   class: 'govuk-button govuk-button--secondary govuk-!-margin-bottom-0 govuk-visually-hidden',
                   type: 'button',
                   data: { module: 'govuk-button' } %>

      <div class="fallback">
        <%# Keep `multiple` to false. This only affects non-javascript version, dropzone %>
        <%# will still support multiple files. This greatly simplifies backend with little downside %>
        <%= f.govuk_file_field :document, multiple: false,
                               label: { size: 'm' }, class: 'govuk-file-upload' %>

        <%= f.button t('.upload_file_button'),
                     class: 'govuk-button govuk-button--secondary',
                     data: { module: 'govuk-button' } %>
      </div>
    <% end %>

    <%= step_form @form_object, html: { class: 'govuk-!-padding-top-5' } do |f| %>
      <div class="app-multi-file__uploaded-files">
        <h2 class="govuk-heading-m"> <%= t('.uploaded_files_heading') %></h2>
        <p class="govuk-body"><%= t('.uploaded_files_info') %></p>
        <table class="govuk-table">
          <thead class="govuk-table__head">
          <tr class="govuk-table__row">
            <th class="govuk-table__header"><%= t('steps.evidence.upload.edit.file_name') %></th>
            <th scope="col" class="govuk-table__header"></th>
          </tr>
          </thead>
          <tbody class="govuk-table__body">
          <%= render partial: 'steps/evidence/upload/uploaded_file',
                     collection: @form_object.documents, as: :document %>
          </tbody>
        </table>
      </div>

      <%= f.continue_button %>
    <% end %>
  </div>
</div>
