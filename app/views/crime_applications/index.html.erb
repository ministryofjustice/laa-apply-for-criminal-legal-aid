<% title t('.page_title') %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full govuk-!-margin-bottom-5">
    <%= render partial: 'shared/flash_banner' %>

    <h1 class="govuk-heading-xl"><%=t '.heading' %></h1>

    <%= button_to crime_applications_path,
                  class: 'govuk-button govuk-button--start',
                  data: { module: 'govuk-button' } do; t('.start_button'); end %>
  </div>
</div>

<nav class="moj-sub-navigation" aria-label="Sub navigation">
  <ul class="moj-sub-navigation__list">
    <li class="moj-sub-navigation__item">
      <% if @applications.size.zero? %>
        <%= link_to(t('.sub_navigation.link_1', count: nil), crime_applications_path, class: 'moj-sub-navigation__link', 'aria-current': 'page') %>
      <% else %>
        <%= link_to(t('.sub_navigation.link_1', count: "(#{@applications.count})"), crime_applications_path, class: 'moj-sub-navigation__link', 'aria-current': 'page') %>
      <% end %>
    </li>

    <li class="moj-sub-navigation__item">
      <% if @submitted_applications_count.zero? %>
        <%= link_to(t('.sub_navigation.link_2', count: nil), completed_crime_applications_path, class: 'moj-sub-navigation__link') %>
      <% else %>
        <%= link_to(t('.sub_navigation.link_2', count: "(#{@submitted_applications_count})"), completed_crime_applications_path, class: 'moj-sub-navigation__link') %>
      <% end %>
    </li>

    <li class="moj-sub-navigation__item">
      <% if @returned_applications_count.zero? %>
          <%= link_to(t('.sub_navigation.link_3', count: nil), completed_crime_applications_path(q: 'returned'), class: 'moj-sub-navigation__link') %>
      <% else %>
        <%= link_to(t('.sub_navigation.link_3', count: "(#{@returned_applications_count})"), completed_crime_applications_path(q: 'returned'), class: 'moj-sub-navigation__link') %>
      <% end %>
    </li>
  </ul>
</nav>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <table class="govuk-table app-dashboard-table">
      <thead class="govuk-table__head">
        <tr class="govuk-table__row">
          <th scope="col" class="govuk-table__header"><%= t('.table_headings.applicant_name') %></th>
          <th scope="col" class="govuk-table__header"><%= t('.table_headings.created_at') %></th>
          <th scope="col" class="govuk-table__header"><%= t('.table_headings.reference') %></th>
          <th scope="col" class="govuk-table__header"><%= t('.table_headings.status') %></th>
          <th scope="col" class="govuk-table__header"><%= t('.table_headings.action') %></th>
        </tr>
      </thead>
      <tbody class="govuk-table__body">
        <% @applications.present_each(CrimeApplicationPresenter) do |app| %>
          <tr class="govuk-table__row">
            <th scope="row" class="govuk-table__header">
              <%= link_to app.applicant_name, edit_crime_application_path(app),
                          class: 'govuk-link--no-visited-state' %>
            </th>
            <td class="govuk-table__cell">
              <%= app.start_date %>
            </td>
            <td class="govuk-table__cell">
              <%= app.laa_reference %>
            </td>
            <td class="govuk-table__cell">
              <%= app.status_tag %>
            </td>
            <td class="govuk-table__cell">
              <%= button_to confirm_destroy_crime_application_path(app), method: :get,
                class: 'govuk-button govuk-button--secondary govuk-!-margin-bottom-0',
                data: { module: 'govuk-button' } do; t('.delete_button'); end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
